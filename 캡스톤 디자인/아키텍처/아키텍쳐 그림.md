## 계층형
```plaintext
@startuml
!theme plain
' 선을 직각으로 만들어서 깔끔하게 정리
skinparam linetype ortho
skinparam componentStyle rectangle
skinparam backgroundColor white


' 1. 최상단: 사용자와 외부 세상
rectangle "External World" {
    actor "User (Client)" as User
    
    package "External APIs" {
        cloud "Google/Kakao\n(Auth)" as AuthAPI
        cloud "AWS S3\n(Image Storage)" as S3API
        cloud "Google Map\n(Map Service)" as MapAPI
    }
}

' 2. 메인 서버 영역 (AWS EC2)
rectangle "AWS EC2 Server (Docker Compose)" {
    
    ' (1) 관문: Nginx
    rectangle "Gateway Layer" {
        component "Nginx Proxy\n(SSL/HTTPS)" as Nginx #E1F5FE
    }

    ' (2) 애플리케이션: 프론트/백/AI
    rectangle "Application Layer" {
        component "Frontend Container\n(React + Vite)" as React #E3F2FD
        component "Backend Container\n(Spring Boot)" as Spring #E8F5E9
        component "AI Container\n(FastAPI)" as FastAPI #F3E5F5
    }

    ' (3) 데이터: DB/캐시
    rectangle "Data Layer" {
        database "MySQL 8.0" as MySQL #FFF3E0
        database "Redis" as Redis #FFEBEE
    }
}

' --- 관계 연결 (깔끔한 흐름) ---

' 1. 사용자 -> Nginx 진입
User --> Nginx : HTTPS (443)

' 2. Nginx -> 각 컨테이너 라우팅
Nginx -down-> React : / (Root)
Nginx -down-> Spring : /api
Nginx -down-> FastAPI : /ai

' 3. 프론트엔드 상호작용
React -up-> MapAPI : 지도 로딩 (Direct)
React -down-> Nginx : API 요청

' 4. 백엔드(Spring) 로직
Spring -down-> MySQL : 데이터 저장
Spring -down-> Redis : 토큰 관리
Spring -up-> S3API : 이미지 업로드
Spring -up-> AuthAPI : 소셜 로그인 검증
Spring -right-> FastAPI : AI 요청 (HTTP)

' 5. AI 로직
FastAPI -down-> MySQL : 로그 저장 (선택)

@enduml
```

## 가로형
```plaintext
@startuml
!theme plain
skinparam handwritten false
skinparam componentStyle rectangle
skinparam backgroundColor white
' 핵심: 왼쪽에서 오른쪽으로 배치
left to right direction


actor "User" as User

package "AWS EC2 Server" {
    component "Nginx\n(Gateway)" as Nginx #E1F5FE
    
    rectangle "Containers" {
        component "React\n(Front)" as React #E3F2FD
        component "Spring Boot\n(Back)" as Spring #E8F5E9
        component "FastAPI\n(AI)" as AI #F3E5F5
    }
    
    rectangle "Database" {
        database "MySQL" as DB #FFF3E0
        database "Redis" as Cache #FFEBEE
    }
}

cloud "External APIs\n(Google, Kakao, S3)" as External

' 연결
User --> Nginx : HTTPS
Nginx --> React
Nginx --> Spring
Nginx --> AI

React --> Spring : API
Spring --> AI : Req
Spring --> DB
Spring --> Cache
Spring --> External
AI --> External : LLM

@enduml
```

## 시퀀스 다이어그램
```plaintext
@startuml
!theme plain
autonumber "<b>[00]"
actor "사용자 (User)" as User
participant "프론트 (React)" as Front #E3F2FD
participant "게이트웨이 (Nginx)" as Nginx #E1F5FE
participant "백엔드 (Spring)" as Spring #E8F5E9
participant "AI 서버 (FastAPI)" as AI #F3E5F5
database "DB/캐시 (MySQL/Redis)" as DB #FFF3E0

== 1. 페이지 접속 및 로그인 ==
User -> Nginx : 사이트 접속 (HTTPS)
Nginx -> Front : React 정적 파일 반환
Front -> User : 화면 표시
User -> Front : 소셜 로그인 클릭
Front -> Spring : OAuth 요청
Spring -> DB : 회원 정보 저장/조회 (MySQL)
Spring -> DB : Refresh Token 저장 (Redis)
Spring --> Front : JWT 발급 (로그인 완료)

== 2. AI 채팅 기능 수행 ==
User -> Front : "여행 코스 추천해줘" (질문)
Front -> Nginx : API 요청 (/api/chat)
Nginx -> Spring : 요청 전달
Spring -> DB : 유효한 토큰인지 검사 (Redis)

group AI 추론 프로세스
    Spring -> AI : 프롬프트 전달 (HTTP)
    activate AI
    AI -> AI : LLM 모델 추론 (LangChain)
    AI --> Spring : 답변 반환 ("추천 코스는...")
    deactivate AI
end

Spring -> DB : 채팅 내역 저장 (MySQL)
Spring --> Front : 최종 응답 (JSON)
Front --> User : 화면에 답변 출력

@enduml
