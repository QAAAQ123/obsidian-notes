- 회원 정보를 통해 인가 작업을 진행하기 때문에 사용자로 부터 회원 가입을 진행한 뒤 데이터베이스에 회원 정보를 저장해야 한다. 
![[spring security 작동 과정.png]]
- Join contorller,service를 통해 회원가입을 진행하여 DB에 회원 데이터를 저장해 놓는다.
```html
<form action="/joinProc" method="post" name="joinForm"> 
		<input type="text" name="username" placeholder="Username"/> 
		<input type="password" name="password" placeholder="Password"/> 
		<input type="submit" value="Join"/> 
</form>
```
- 위 form에서 버튼을 누르면 /joinProc 경로로 유저 ID,PW 데이터가 전송된다. 따라서 /joinProc 경로로 데이터를 받아줄 @PostMapping 메소드를 작성해야 한다.
- 컨트롤러에서 @PostMapping 메소드를 작성하고, 로직을 수행할 Service 계층을 만들어야 한다.
- service 계층을 만들고 service를 controller에 의존성 주입을 한다.
- service를 작성하기 위해서는 repository와 entitiy가 필요하다. 
- User Entity를 작성할 때 반드시 ==**role**== 변수가 있어야 한다.
```java
@Entity  
public class UserEntity {  
  
    @Id  
    @GeneratedValue(strategy = GenerationType.IDENTITY)  
    private Long id;  
  
    private String username;  
    private String password;  
	//role이 반드시 존재해야 함
    private String role;  
  
}
```

- service 계층 메소드
```java
public void JoinProcess(JoinDTO joinDTO){  
    UserEntity data = new UserEntity();  
  
    //db에 이미 동일한 username을 가진 user가 존재하는지 확인해야함  
  
    data.setUsername(joinDTO.getUsername());  
    //비밀번호는 반드시 암호화 하여 저장해야 한다.  
    data.setPassword(bCryptPasswordEncoder.encode(joinDTO.getPassword()));  
    //ROLE_ 뒤에 알맞은 역할 문자열 작성  
    data.setRole("ROLE_USER");  
  
    userRepository.save(data);  
}
```
1. 비밀번호 암호화
2. Role 설정

## 회원 가입 로직 작성시 중요한 점
1. 클라이언트에서 http request type은 ~={red}**POST**=~이다.
2. user 정보를 저장할 Entity에는 반드시 ~={red}**role을 저장하는 변수**=~가 있어야 한다.
3. Service 계층에서 DB로 데이터 저장 과정에서 ~={red}**비밀번호를 반드시 암호화**=~ 해야 한다.
4. Service 계층에서 DB로 데이터 저장 과정에서 ~={red}**role을 ROLE_XXXX로**=~ 반드시 작성해야 한다.
