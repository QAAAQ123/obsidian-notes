## 계층 권한
- 각각의 권한을 계층화 하고 싶을 경우에 사용

- 기존의 authorizeHttpRequest() 메소드 방식은 Role이 많을 경우 다루기 어렵다는 문제가 존재한다.
- 이 문제를 계층 권한 메소드 등록을 통하여 해결한다

## 계층 권한 메소드 등록
```java
//6.3.x 이전 버전에서만 사용 가능
@Bean
public RoleHierarchy roleHierarchy() {

    RoleHierarchyImpl hierarchy = new RoleHierarchyImpl();

    hierarchy.setHierarchy("ROLE_C > ROLE_B\n" +
            "ROLE_B > ROLE_A");

    return hierarchy;
}
```
- 위 메소드를 추가한 이후에 기존 authorizeHttpRequest()안의 코드를 수정해준다.
```java
@Bean
public SecurityFilterChain filterChain(HttpSecurity http) throws Exception{

    http
            .csrf((auth) -> auth.disable());

    http
            .authorizeHttpRequests((auth) -> auth
                    .requestMatchers("/login").permitAll()
                    .requestMatchers("/").hasAnyRole("A")
                    .requestMatchers("/manager").hasAnyRole("B")
                    .requestMatchers("/admin").hasAnyRole("C")
                    .anyRequest().authenticated()
            );

    http
            .formLogin((auth) -> auth.loginPage("/login")
                    .loginProcessingUrl("/loginProc")
                    .permitAll()
            );

    return http.build();
}
```

## 6.3.x 버전 이후 사용 계층 권한 사용 방식 
- 기존의 방식을 통해 사용이 불가능하게 변경 되었다.
- 기존 new로 생성해야 하는 부분이 static으로 변경
- [변경](https://github.com/spring-projects/spring-security/blob/main/core/src/main/java/org/springframework/security/access/hierarchicalroles/RoleHierarchyImpl.java)
```java
@Bean
public RoleHierarchy roleHierarchy() {

    return RoleHierarchyImpl.fromHierarchy("""
            ROLE_C > ROLE_B
            ROLE_B > ROLE_A
            """);
}

@Bean
public RoleHierarchy roleHierarchy() {

    return RoleHierarchyImpl.withDefaultRolePrefix()
            .role("C").implies("B")
            .role("B").implies("A")
            .build();
}
위 2가지 방식으로 작성해야 한다.
```