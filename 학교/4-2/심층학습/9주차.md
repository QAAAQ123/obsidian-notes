## pytorch 코드 구현
- 모두 다루기는 어렵다
- 시험에 출제하지 않음-실생활에서 어떻게 사용되는지 
## 합성곱 신경망(CNN)
- 이미지 데이터와 공간 정보를 처리 할 때 활용된다. 
- 이미지 데이터를 MLP를 통해서 하면 여러가지 한계점
	- 공간 정보의 손실
		- 500x800인 이미지를 MLP로 넣는다.
		- MLP는 1차원의 벡터로만 입력을 넣을 수 있기 때문에 그대로 넣을 수 없다.
		- 평탄화작업을 해야한다. 
		- 평탄화작업을 하면 필셀간의 인접성,지역성,위치 관계가 사라지는 문제 발생
		- 인접성: 인접한 픽셀이 유사한 특징을 가질 수 있는 성질
		- 지역성: 국소적 지역에 있는 특징
		- 위치 관계: 서로 다른 특징간의 관계(코는 눈보다 아래 있다.)
	- 파라미터 폭증
		- 이미지 크기에 비례하여 학습 파라미터의 수가 기하급수적으로 증가하는 문제
		- 500x800x3(한 픽셀당 R,G,B 3개의 값 가지기 때문에)
		- 120만개의 값을 가지고 있다 -> MLP의 입력으로 주게되면 입력은 120만개,2번째 층의 노드 수가 1024개이면 가중치 행렬이 120만 x 1024=12억개
		- 개,고양이로 분류하면 1024x2 = 2048개 
		- 결론: 10억개가 넘는 가중치 필요
	- 위치 불변성 결여
		- 같은 패턴이라도 이미지 내 위치가 바뀌면 모델의 출력이 달라지는 성질
		- 같은 강아지인데도 서로 다르게 해석함
		- 같은 숫자 7이여도 다르게 해석함->손글씨 7이 2나 8로 다르게 예측 할 가능성 있음
- 한계점 해결 네트워크 필요성 대두: 합성곱 신경망 제안됨
	- 실제 뇌에서 시작 정보 처리하는 방식에 영감을 얻어서 네트워크 구조가 설계됨
	- 처리 과정: 시각 정보 들어옴 -> V1,V2,V4,IT 순서로 동작하며 정보 처리(단순한 모양에서 고차원적인 정보로)(누적)
		- V1:단순한 선과 모서리 정보 파악
		- V2: 선과 모서리를 모아서 조합->모양 정보 파악
		- V4,IT: 더 큰 범위의 객체 인식
	- 상위 영역으로 전달될수록 뉴런의 수용 영역이 확대 됨
	- 저수준의 물리적 특징이 고수준의 의미적 표현으로 일반화(물리 -> 의미)
- CNN: 이미지 인식 및 처리에 뛰어난 성능을 보이는 신경망 구조/단순한 시각 요소에서 시작하여 고차원 의미로 추상화 되는 계층적 표현 구조를 학습
	- 저수준 특징: 물리적 특징(엣지,선,코너,색상,질감,밝기 등)
	- 고수준 특징: 저수준의 특징들이 모여서(형태,객체,얼굴,장면 등)
- CNN 전체 구조(특징 뽑아서 분류)
	- 특징 추출기와 분류기로 구성
	- 특징 추출기: 이미지로부터 유의미한 시각적 특징을 자동으로 학습 및 추출(중요한 특징을 추출)
		- 합성곱과 Pooling계층으로 이루어져있음
	- 분류기: 추출된 특징을 통해서 입력 이미지가 어떤 클래스에 속하는지를 판별
	- 특징 추출->1차원 벡터로 Flatten(평탄화) 시킴 -> 분류
	- 1차원으로 할거면 왜 특징 추출 과정을 포함하는지
		- 특징 정보는 압축된 정보이기 때문에 크기가 작다->파라미터 폭증 문제 완화
		- 2차원에서 뽑기 때문에 구조적 정보도 같이 가지고 있다.
- 합성곱 계층
	- 격자 구조의 공간적인 패턴을 학습할 수 있도록 설계된 신경망
	- 입력 데이터로부터 **지역적인 특징을 추출**
	- 커널이 입력 이미지의 영역을 스캔하며 각 위치에서 합성곱 연산을 수행
	- 커널(필터): 입력 데이터의 패턴을 감지하는 공유된 가중치(그림의 3x3)
	- 왜 공유된 가중치: 모든 지역을 스캔할때 각각의 개별 가중치가 같다
- 합성곱 연산
	- 1. 커널과 겹치는 영역의 값을 곱셈 2. 곱한 결과 덧셈
- 커널은 학습되는 파라미터이다. 
	- 여러개의 커널을 사용하는데, 서로 다른 방식으로 커널이 학습되면서 서로다른 특징을 추출하도록 학습된다. 
	- 커널: 서로 다른 방식으로 학습이 진행되는 값.
- 슬라이딩: 영역을 스캔하면서 곱하며 이동하는 것
- 특징의 크기가 작아진다-> 중요한 특징 정보가 압축된다. -> 계층적인 특징 정보를 누적하며 학습한다. 
- 합성곱 계층
	- 스트라이드: 커널이 한번 이동할때 한번에 건너뛰는 픽셀 수(하이퍼파라미터)-겹침 정도 조절
		- 스트라이드 작게-특징 겹침 정도가 높아짐
		- 스트라이드 높게-특징 겹침 정도가 작아짐
	- 제로 패딩: 입력 행렬의 가장자리에 0을 대칭적으로 추가하는 과정(몇겹의 패딩으로 할지 정할 수 있음 -> 하이퍼파라미터)
		- 가장자리 부분이 손실되지 않도록 보호-가장자리 정보는 가운데에 비해서 계산 횟수가 적음
		- 출력 특징 맵의 크기를 조절: 계산 횟수 늘어남 -> 출력 특징 맵의 크기 증가
- 스트라이드 키울수록 출력 특징 맵의 크기가 작아진다.(이동하는 거리가 늘어나기 때문에)
- **~={red}출력 크기 공식(시험)=~** = `출력 크기 = [(입력 크기 - 커널 크기 + 2 * 패딩 크기)/스트라이드 ] +1 `